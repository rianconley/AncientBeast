(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{311:function(e,t,a){"use strict";a.r(t);var r=a(0),i=a(113),n=a(26),s=a(42),u=a(10),o=a(2),h=a(114);t.default=function(e){e.abilities[5]=[{trigger:"onUnderAttack",require:function(){return!0},activate:function(t){if(void 0===t)return!1;if(!t.damages.shock)return!1;this.end();var a=Math.floor(t.damages.shock/4);t.damages.shock-=a;var r=a-(this.creature.stats.energy-this.creature.energy);return this.creature.recharge(a),this.isUpgraded()&&r>0&&this.creature.heal(r),e.log("%CreatureName"+this.creature.id+"% absorbs "+a+" shock damage into energy"),t}},{trigger:"onQuery",_targetTeam:n.a.enemy,require:function(){return!!this.testRequirements()&&!!this.atLeastOneTarget(this._getHexes(),{team:this._targetTeam})},query:function(){var t=this,a=this.creature;e.grid.queryCreature({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:a.id,flipped:a.flipped,hexes:this._getHexes()})},activate:function(t){this.end();var a=r.extend({poison:0},this.damages1);this.isUpgraded()&&(a.poison=this.damages1.poison),e.UI.checkAbilities();var n=new i.a(this.creature,a,1,[],e),s=t.takeDamage(n);s.damages&&s.damages.total>0&&(this.creature.remainingMove=this.creature.stats.movement,e.log("%CreatureName"+this.creature.id+"%'s movement recharged"),e.activeCreature.queryMove())},_getHexes:function(){return e.grid.getHexMap(this.creature.x-3,this.creature.y-2,0,!1,s.j)}},{trigger:"onQuery",_targetTeam:n.a.enemy,require:function(){return!!this.atLeastOneTarget(this._getHexes(),{team:this._targetTeam})&&this.testRequirements()},query:function(){var t=this,a=this.creature;e.grid.queryCreature({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:a.id,flipped:a.flipped,hexes:this._getHexes()})},activate:function(t){this.end();var a=this.damages,r=this.isUpgraded()?0:1,n=this;t.addEffect(new h.a(n.title,t,t,"onUnderAttack",{effectFn:function(e,a){a.applyDamage().total>=t.health&&t.hexagons.forEach((function(e){e.destroyTrap()}))}},e));var s=new h.a(n.title,n.creature,this,"onStepOut",{effectFn:function(r){e.log("%CreatureName"+r.target.id+"% is hit by "+r.name),r.target.takeDamage(new i.a(r.owner,a,1,[],e),{isFromTrap:!0}),t.hexagons.forEach((function(e){e.destroyTrap()})),r.deleteEffect()}},e);t.hexagons.forEach((function(e){e.createTrap("poisonous-vine",[s],n.creature.player,{turnLifetime:r,fullTurnLifetime:!0,ownerCreature:n.creature,destroyOnActivate:!0,destroyAnimation:"shrinkDown"})}))},_getHexes:function(){var t=e.grid.hexes[this.creature.y][this.creature.x].adjacentHex(2);return u.a(t,this.creature.size,e.grid)}},{trigger:"onQuery",_targetTeam:n.a.both,require:function(){return!!this.testRequirements()&&!!this.atLeastOneTarget(this._getHexes(),{team:this._targetTeam})},query:function(){var t=this;e.grid.queryCreature({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:this.creature.id,flipped:this.creature.flipped,hexes:this._getHexes()})},activate:function(t){var a=this,s=this;s.end();var u=[];u.push(t);for(var c=r.extend({},s.damages),g=function(t){var r=u[t];a.isUpgraded()&&Object(n.b)(a.creature,r,n.a.ally)&&r.addEffect(new h.a(a.title,a.creature,r,"onUnderAttack",{effectFn:function(e,t){for(;;){var a=t.applyDamage();if(a.total<=0||t.damages.shock<=0||r.health<=1){t.damages={shock:0};break}if(!(a.total>=r.health))break;t.damages.shock--}},deleteTrigger:"onEndPhase",noLog:!0},e));var g=new i.a(s.creature,c,1,[],e);if(void 0===(c=r.takeDamage(g)).damages)return"break";if(c.kill)return"break";if(c.damages.total<=0)return"break";if(""!==c.damageObj.status)return"break";delete c.damages.total,c=c.damages;var d=s.getTargets(r.adjacentHexes(1,!0));if(0===(d=d.filter((function(e){return void 0!==e.hexesHit&&-1==u.indexOf(e.target)}))).length)return"break";for(var f={size:0,stats:{defense:-99999,shock:-99999}},m=0;m<d.length;m++)if(void 0!==d[m]){var l=d[m].target;l.stats.shock>f.stats.shock&&(l==s.creature&&1==d.length||l!=s.creature)&&(f=l)}if(!(f instanceof o.a))return"break";u.push(f)},d=0;d<u.length;d++){if("break"===g(d))break}},_getHexes:function(){return e.grid.getHexMap(this.creature.x-3,this.creature.y-2,0,!1,s.j)}}]}}}]);